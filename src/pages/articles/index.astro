---
import BaseLayout from "../../layouts/BaseLayout.astro";
import SiteHeader from "../../components/SiteHeader.astro";
import SiteFooter from "../../components/SiteFooter.astro";
import SectionHeader from "../../components/SectionHeader.astro";
import ContentCard from "../../components/ContentCard.astro";
import { getCollection } from "astro:content";
import { formatDate } from "../../utils/formatDate";

const articles = (await getCollection("articles"))
  .filter((entry) => !entry.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<BaseLayout title="Articles">
  <SiteHeader />
  <main class="container section">
    <SectionHeader
      kicker="Writing"
      title="Articles"
      description="Long-form essays, notes, and research writing."
    />
    <div class="grid grid-3">
      {articles.map((entry) => (
        <ContentCard
          href={`/articles/${entry.slug}`}
          title={entry.data.title}
          description={entry.data.description}
          meta={formatDate(entry.data.date)}
          image={entry.data.heroImage}
          tags={entry.data.tags}
        />
      ))}
    </div>
  </main>
  <SiteFooter />
</BaseLayout>
